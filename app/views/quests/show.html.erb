<% provide(:title, @quest.name) %>

<h1><%= @quest.name %></h1>

<p><%= simple_format @quest.description %></p>

<div class="container">
  <ul class="setup_links center">
    <% if current_user.player.accepted?(@quest) %>
      <%= form_for(current_player) do |f| %>
        <%= f.hidden_field :quest, value: @quest.id %>
        <h2>Rewards:</h2>
        <% @quest.rewards[:items].each do |key, value| %>
          <%= simple_format(pluralize(value, key.to_s) + "\n") %>
          <%= f.hidden_field "items[#{key}]", value: value %>
        <% end %>
        <% @quest.rewards[:stats].each do |key, value| %>
          <%= simple_format(value.to_s + " " + key.to_s + "\n") %>
          <%= f.hidden_field key, value: value %>
        <% end %>
        <li><%= link_to "Back", quests_path %></li>
        <% if current_player.completed?(@quest) %>
          <td><%= f.submit "Turn in", class: "btn btn-primary", id: "shop" %></td>
        <% else %>
          <li><td id="accepted">Accepted</td></li>
        <% end %>
      <% end %>
    <% else %>
      <li><%= link_to "Accept", quests_accept_path(@quest[:id]) %></li>
      <li><%= link_to "Decline", quests_path %></li>
    <% end %>
  </ul>
</div>